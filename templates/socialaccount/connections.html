{% extends "socialaccount/base.html" %}

{% load i18n %}

{% block head_title %}{% trans "Account Connections" %}{% endblock %}

{% block content %}
<div class="auth-header">
    <h1 class="auth-title">{% trans "Account Connections" %}</h1>
    <p class="auth-subtitle">
        {% blocktranslate %}You can sign in to your account using any of the following third party accounts:{% endblocktranslate %}
    </p>
</div>

{% if form.accounts %}
<form method="post" action="{% url 'socialaccount_connections' %}">
    {% csrf_token %}

    <div class="connections-list">
        {% for base_account in form.accounts %}
        {% with base_account.get_provider_account as account %}
        <div class="connection-item">
            <div class="connection-info">
                <div class="connection-logo">
                    {% if account.get_brand.logo %}
                    <img src="{{ account.get_brand.logo }}" alt="{{ account.get_brand.name }}">
                    {% else %}
                    <i class="fas fa-user-circle"></i>
                    {% endif %}
                </div>
                <div class="connection-details">
                    <h3 class="connection-name">{{ account.get_brand.name }}</h3>
                    <p class="connection-id">{{ account }}</p>
                </div>
            </div>
            <div class="connection-action">
                <label for="id_account_{{ base_account.id }}">
                    <input id="id_account_{{ base_account.id }}" type="radio" name="account" value="{{ base_account.id }}">
                    <span>{% trans 'Disconnect' %}</span>
                </label>
            </div>
        </div>
        {% endwith %}
        {% endfor %}
    </div>

    <div class="connection-submit">
        <button class="auth-btn danger" type="submit">{% trans 'Remove' %}</button>
    </div>
</form>
{% else %}
<p class="no-connections">{% trans 'You currently have no social network accounts connected to this account.' %}</p>
{% endif %}

<div class="divider">
    <span>{% trans "Add a 3rd Party Account" %}</span>
</div>

<div class="social-login">
    {% include "socialaccount/snippets/provider_list.html" with process="connect" %}
</div>

<style>
    .connections-list {
        margin-bottom: 2rem;
    }

    .connection-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius-md);
        margin-bottom: 0.8rem;
        transition: all 0.3s ease;
    }

    .connection-item:hover {
        box-shadow: var(--shadow-sm);
        border-color: var(--primary-light);
    }

    .connection-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .connection-logo {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .connection-logo img {
        max-width: 100%;
        max-height: 100%;
    }

    .connection-logo i {
        font-size: 2rem;
        color: var(--text-light);
    }

    .connection-name {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 0.2rem;
    }

    .connection-id {
        font-size: 0.9rem;
        color: var(--text-light);
    }

    .connection-action label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
    }

    .connection-submit {
        margin-top: 1rem;
    }

    .auth-btn.danger {
        background: linear-gradient(135deg, #dc3545, #c82333);
    }

    .no-connections {
        text-align: center;
        padding: 2rem;
        color: var(--text-light);
        border: 1px dashed var(--border-color);
        border-radius: var(--border-radius-md);
        margin-bottom: 2rem;
    }
</style>

<script type="text/javascript">
(function() {
    var message = "{% trans 'Do you really want to disconnect this account?' %}";
    document.addEventListener("DOMContentLoaded", function() {
        var form = document.querySelector("form[action='{% url 'socialaccount_connections' %}']");
        if (form) {
            form.addEventListener("submit", function(e) {
                if (!confirm(message)) {
                    e.preventDefault();
                }
            });
        }
    });
})();
</script>
{% endblock %}